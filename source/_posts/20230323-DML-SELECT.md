---
title: DML SELECT
date: 2023-03-23 14:59:53
tags:
---

SELECT문은 테이블을 구성하는 튜플(행)들 중에서 **전체 또는 조건을 만족하는 튜플(행)을 검색하여 주기억장치 상에 임시 테이블로 구성**하는 명령문이다.

## 일반 형식

```sql
SELECT PREDICATE [테이블명,]속성명1, [테이블명,]속성명2, ...
FROM 테이블명1, 테이블명2,...
[WHERE 조건]
[GROUP BY 속성명1, 속성명2, ...]
[HAVING 조건]
[ORDER BY 속성명 [ASC | DEAC]];
```

- 속성명 : 검색하여 불러온 속성(열) 또는 속성을 이용한 수식을 지정한다.
  - 기본 테이블을 구성하는 모든 속성을 지정할 때는 '\*'를 기술한다.
  - 두 개 이상의 테이블을 대상으로 검색할 때는 '테이블명.속성명'으로 표현한다.
- PREDICATE : 불러올 튜플 수를 제한할 명령어를 기술한다.
  - ALL : 모든 튜플을 검색할 때 지정하는 것으로, 주로 생략합니다.
  - DISTINCT : 중복된 튜플이 있으면 그 중 첫 번째 한 개만 검색합니다.
  - DISINCTROW : 중복된 튜플을 제거하고 한 개만 검색하지만 선택된 속성의 값이 아닌, 튜플 전체를 대상으로 합니다.

<BR>

- FORM절 : 질의에 의해 검색될 데이터들을 포함하는 테이블명을 기술한다.
- WHERE절 : 검색할 조건을 기술한다.
- GROUP BY절 : 특정 속성을 기준으로 그룹화하여 검색할 때 그룹화할 속성을 지정한다.
- 일반적으로 GROUP BY절은 그룹 함수와 함께 사용된다.
- HAVING절 : GROUP BY와 함께 사용되며, 그룹에 대한 조건을 지정한다.
- ORDER BY절 : 특정 속성을 기준으로 정렬하며 검색할 때 사용한다.
  - 속성명 : 정렬의 기준이 되는 속성명을 기술한다.
  - [ASC|DESC] : 정렬 방식으로서'ASC'는 오름차순, 'DESC'는 내림차순이다, 생략하면 오름차순'ASC'으로 지정된다.

## 기본검색

SELECT절에 원하는 속성을 지정하여 검색한다.

| 이름   | 부서   | 생일     | 주소   | 기본급 |
| ------ | ------ | -------- | ------ | ------ |
| 홍길동 | 기획   | 04/05/61 | 망원동 | 120    |
| 임꺽정 | 인터넷 | 01/09/69 | 망원동 | 80     |
| 황진이 | 편집   | 07/21/75 | 망원동 | 100    |
| 김선달 | 편집   | 10/22/73 | 망원동 | 90     |
| 성춘향 | 기획   | 02/20/64 | 망원동 | 100    |
| 장길산 | 편집   | 03/11/67 | 망원동 | 120    |
| 일지매 | 기획   | 04/29/78 | 망원동 | 110    |
| 강건달 | 인터넷 | 12/11/80 | 망원동 | 90     |

| 이름   | 취미       | 경력 |
| ------ | ---------- | ---- |
| 김선달 | 당구       | 10   |
| 선춘향 | 나이트댄스 | 5    |
| 일지매 | 택견       | 15   |
| 임꺽정 | 씨름       | 8    |

```sql
SELECT FROM 사원;
SELECT 사원 FROM 사원;
SELECT 이름, 부서, 생일, 주소, 기본급 FROM 사원;
SELECT 사원.이름, 사원.부서, 사원.생일, 사원.주소, 사원.기본급 FROM 사원;
```

- Q1 <사원> 테이블의 모든 튜플을 검색하시오.

```sql
SELECT * FROM 사원;
```

- 위의 SQL은 모두 보기에 주어진 <사원> 테이블 전체를 그대로 출력합니다.

- Q2 <사원> 테이블에서 주소만 검색하되 같은 주소는 한 번만 출력하시오.

```sql
SELECT DISTINCT 주소
FROM 사원;
```

| 주소   |
| ------ |
| 대교동 |
| 망원동 |
| 상암동 |
| 서교동 |
| 연남동 |
| 합정동 |

- Q3 <사원> 테이블에서 '기본급'에 특별수당 10을 더한 월급을 "XX부서의 XXX의 월급 XXX"형태로 출력하시오.

```sql
SELECT 부서 + '부서의' AS 부서2, 이름 + '의 월급',AS 이름, 기본급 + 10 AS RLQHSRMQ2
FROM 사원;
```

| 부서         | 이름2         | 기본급2 |
| ------------ | ------------- | ------- |
| 기획부서의   | 홍길동의 월급 | 130     |
| 인터넷부서의 | 임꺽정의 월급 | 90      |
| 편집부서의   | 황진이의 월급 | 110     |
| 편집부서의   | 김건달의 월급 | 100     |
| 기획부서의   | 성춘향의 월급 | 110     |
| 편집부서의   | 장길산의 월급 | 130     |
| 기획부서의   | 일지매의 월급 | 120     |
| 인터넷부서의 | 강건달의 월급 | 100     |

## 조건 지정 검색

WHERE절에 조건을 지정하여 조건에 만족하는 튜플을 검색한다.

- Q1 <사원> 테이블에서 '기획' 부의 모든 튜플을 검색하시오.

```sql
SELECT *
FROM 사원
WHERE 부서 = '기획';
```

| 이름   | 부서 | 생일     | 주소   | 기본급 |
| ------ | ---- | -------- | ------ | ------ |
| 홍길동 | 기획 | 04/05/61 | 망원동 | 120    |
| 성춘향 | 기획 | 02/20/64 | 대흥동 | 100    |
| 일지매 | 기획 | 04/29/78 | 연남동 | 110    |

- Q2 <사원> 테이블에서 부서는 '기획'이고, 기본급이 110보다 큰 튜플을 검색하는 SQL문을 작성하시오.

```sql
SELECT *
FROM 사원
WHERE 부서 = '기획' AND 기본급 > 110;
```

| 이름   | 부서 | 생일     | 주소   | 기본급 |
| ------ | ---- | -------- | ------ | ------ |
| 홍길동 | 기획 | 04/05/61 | 망원동 | 120    |

- Q3 <사원> 테이블에서 '부서'가 "기획" 이거나 "인터넷"인 튜플을 검색하시오.

```sql
SELECT *
FROM 사원
WHERE 부서= '기획' OR 부서 = '인터넷';
```

| 이름   | 부서   | 생일     | 주소   | 기본급 |
| ------ | ------ | -------- | ------ | ------ |
| 홍길동 | 기획   | 04/05/61 | 망원동 | 120    |
| 임꺽정 | 인터넷 | 01/09/69 | 서교동 | 80     |
| 성춘향 | 기획   | 02/20/64 | 대흥동 | 100    |
| 일지매 | 기획   | 04/29/78 | 연남동 | 110    |
| 강건달 | 인터넷 | 12/11/80 |        | 90     |

- Q4 <사원> 테이블에서 성이 '김'인 사람의 튜플을 검색하시오.

```sql
SELECT *
FROM 사원
WHERE 이름 LIKE '김%'
```

| 이름   | 부서 | 생일     | 주소   | 기본급 |
| ------ | ---- | -------- | ------ | ------ |
| 김선달 | 편집 | 10/22/73 | 망원동 | 90     |

- q5 <사원> 테이블에서 '생일'이 '01/01/69'에서 '12/31/73'사이인 튜플을 검색하시오.

```sql
SELECT *
FROM 사원
WHERE 생일 BETWEEN #01/01/69# AND #12/31/73#;
```

| 이름   | 부서   | 생일     | 주소   | 기본급 |
| ------ | ------ | -------- | ------ | ------ |
| 임꺽정 | 인터넷 | 01/09/69 | 서교동 | 80     |
| 김선달 | 편집   | 10/22/73 | 망원동 | 90     |

- Q6 <사원> 테이블에서 '주소'가 NULL인 튜플을 검색하시오.

```sql
SELECT *
FROM 사원
WHERE 주소 IS NULL;
```

| 이름   | 부서   | 생일     | 주소 | 기본급 |
| ------ | ------ | -------- | ---- | ------ |
| 강건달 | 인터넷 | 12/11/80 |      | 90     |

## 정렬 검색

ORDER BY절에 특정 속성을 지정하여 지정된 속성으로 자료를 정렬하여 검색한다.

- Q1 <사원> 테이블에서 '주소'를 기준으로 내림차순 정렬시켜 상위2개 튜플만 검색하시오.

```sql
SELECT TOP 2 *
FROM 사원
DRDER BY 주소 DESC;
```

| 이름   | 부서 | 생일     | 주소   | 기본급 |
| ------ | ---- | -------- | ------ | ------ |
| 황진이 | 편집 | 07/21/75 | 합정동 | 100    |
| 일지매 | 기획 | 04/29/78 | 연남동 | 110    |

- Q2 <사원> 테이블에서'부서'를 기준으로 오름차순 정렬하고, 같은 부서에 대해서는 '이름'을 기준으로 내림차순 정렬시켜서 검색하시오.

```sql
SELECT *
FROM 사원
ORDER BY 부서 ASC,이름 DESC;
```

| 이름   | 부서   | 생일     | 주소   | 기본급 |
| ------ | ------ | -------- | ------ | ------ |
| 홍길동 | 기획   | 04/05/61 | 망원동 | 120    |
| 일지매 | 기획   | 04/29/78 | 연남동 | 110    |
| 성춘향 | 기획   | 02/20/64 | 대홍동 | 100    |
| 임꺽정 | 인터넷 | 01/09/69 | 서교동 | 80     |
| 강건달 | 인터넷 | 12/11/80 |        | 90     |
| 황진이 | 편집   | 07/21/75 | 합정동 | 100    |
| 장길산 | 편집   | 03/11/67 | 상암동 | 120    |
| 김선달 | 편집   | 10/22/73 | 망원동 | 90     |

## 그룹지정 검색

GROUP BY절에 지정한 속성을 기준으로 자료를 그룹화하여 검색한다.

- Q1 <사원> 테이블에서 '부서'별 '기본급'의 평균을 구하시오.

```sql
SELECT 부서, AVG(기본급) AS 평균
FROM 사원
GROUP BY 부서;
```

| 부서   | 평균  |
| ------ | ----- |
| 기획   | 110   |
| 인터넷 | 85    |
| 편집   | 103.3 |

- Q2 <사원> 테이블에서 '부서'별 튜플 수를 검색하시오.

```sql
SELECT 부서, COUNT(*) AS 사원수
FROM 사원
GROUP BY 부서;
```

| 결과   | 사원수 |
| ------ | ------ |
| 기획   | 3      |
| 인터넷 | 2      |
| 편집   | 3      |

- Q3 <사원> 테이블에서 '기본급'이 100이상인 사원이 2명 이상인 '부서'의 튜플 수를 구하시오.

```sql
SELECT 부서, COUNT(*) AS 사원수
FROM 사원
WHERE 기본급>=100
GROUP BY 부서
HVAING COUNT(*) >=2;
```

| 결과 | 사원수 |
| ---- | ------ |
| 기획 | 3      |
| 편집 | 2      |

## 하위 질의

하위 질의가 있는 질의문은 조건절에 주어진 하위 질의를 먼저 수행하며 그 검색 결과를 조건절의 피연산자로 사용한다.

- Q1 '취미'가 "나이트댄스"인 사원의 '이름'과 '주소'를 검색하시오.

```sql
SELECT 이름, 주소
FROM 사원
WHERE 이름=(SELECT 이름 FROM 여가활동 WHERE 취미='나이트댄스');
```

| 이름   | 주소   |
| ------ | ------ |
| 성춘향 | 대흥동 |

- Q2 취미활동을 하지 않는 사원들을 검색하시오.

```sql
SELECT *
FROM 사원
WHERE 이름 NOT IN (SELECT 이름 FROM 여가활동);
```

| 이름   | 부서   | 생일     | 주소   | 기본급 |
| ------ | ------ | -------- | ------ | ------ |
| 홍길동 | 기획   | 04/05/61 | 망원동 | 120    |
| 환진이 | 편집   | 07/21/75 | 합정동 | 100    |
| 장길산 | 편집   | 03/11/67 | 상암동 | 120    |
| 강건달 | 인터넷 | 12/11/80 |        | 90     |

## 통합(UNION) 질의

두 SELECT문의 조회 결과를 통합하여 검색한다.

- Q1 사원들의 명단이 <사원> 테이블과 <직원> 테이블에 저장되어 있다. 두 테이블을 통합하는 질의문을 작성하시오. 단. 같은 레코드가 두 번 나오지 않게 하시오.

| 사원   | 직급 |
| ------ | ---- |
| 김형석 | 대리 |
| 홍연선 | 과장 |
| 류기선 | 부장 |
| 김현천 | 이사 |

| 사원   | 직급 |
| ------ | ---- |
| 신원섭 | 이사 |
| 이성호 | 대리 |
| 홍영선 | 과장 |
| 류기선 | 부장 |

```sql
SELECT *
FROM 사원
UNION
SELECT *
FROM 직원;
```

| 사원   | 직급 |
| ------ | ---- |
| 김현천 | 이사 |
| 김형석 | 대리 |
| 류기선 | 부장 |
| 신원섭 | 이사 |
| 이성호 | 대리 |
| 홍영선 | 과장 |
